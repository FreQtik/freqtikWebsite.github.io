<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sudoku for Mom</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: #f9f9f9;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    h1 {
      margin-bottom: 10px;
    }
    #sudoku-board {
      display: grid;
      grid-template-columns: repeat(9, 1fr);
      gap: 1px;
      background: black;
      width: 90vmin;
      height: 90vmin;
      max-width: 500px;
    }
    .cell {
      background: white;
      font-size: 2.5vmin;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: none;
      outline: none;
    }
    .cell.fixed {
      background: #e0e0e0;
      font-weight: bold;
      pointer-events: none;
    }
    .cell:nth-child(3n) {
      border-right: 2px solid black;
    }
    .cell:nth-child(n+19):nth-child(-n+27),
    .cell:nth-child(n+46):nth-child(-n+54),
    .cell:nth-child(n+73):nth-child(-n+81) {
      border-bottom: 2px solid black;
    }

    #controls {
      margin: 20px;
      text-align: center;
    }
    select, button {
      margin: 5px;
      font-size: 16px;
      padding: 6px 10px;
    }

    #timer, #best-time {
      margin-top: 10px;
      font-size: 18px;
    }

    #help {
      margin-top: 10px;
      cursor: pointer;
      color: blue;
      text-decoration: underline;
    }

    #help-box {
      display: none;
      background: #fff;
      border: 1px solid #ccc;
      padding: 10px;
      max-width: 500px;
    }

    @media (max-width: 600px) {
      .cell {
        font-size: 3.5vmin;
      }
    }
  </style>
</head>
<body>
  <h1>Sudoku for Mom üß©</h1>
  <div id="sudoku-board"></div>

  <div id="controls">
    <select id="difficulty">
      <option value="easy">Easy</option>
      <option value="medium" selected>Medium</option>
      <option value="hard">Hard</option>
    </select>
    <button onclick="startGame()">New Game</button>
    <button onclick="checkSudoku()">Check</button>
    <div id="timer">‚è±Ô∏è Time: 0s</div>
    <div id="best-time">üèÜ Best: --</div>
    <div id="help" onclick="toggleHelp()">‚ùì How to play</div>
    <div id="help-box">
      <p><strong>Tips:</strong></p>
      <ul>
        <li>Each row, column, and 3x3 square must contain numbers 1-9 without repeating.</li>
        <li>Use logic! Start with rows/columns that have the most numbers.</li>
        <li>Use the process of elimination for tricky cells.</li>
      </ul>
    </div>
  </div>

  <script>
    const board = document.getElementById("sudoku-board");
    const timerEl = document.getElementById("timer");
    const bestEl = document.getElementById("best-time");
    const difficultyEl = document.getElementById("difficulty");

    let selectedCell = null;
    let startTime, timerInterval;
    let currentDifficulty = "medium";

    function generateSudoku(difficulty = "medium") {
      const emptyCount = { easy: 30, medium: 45, hard: 55 }[difficulty];
      const fullBoard = generateFullBoard();
      const puzzle = fullBoard.map(row => row.slice());
      for (let i = 0; i < emptyCount; i++) {
        const r = Math.floor(Math.random() * 9);
        const c = Math.floor(Math.random() * 9);
        puzzle[r][c] = "";
      }
      return [puzzle, fullBoard];
    }

    function generateFullBoard() {
      let board = Array.from({ length: 9 }, () => Array(9).fill(""));
      solveBoard(board);
      return board;
    }

    function solveBoard(board) {
      for (let r = 0; r < 9; r++) {
        for (let c = 0; c < 9; c++) {
          if (board[r][c] === "") {
            for (let n = 1; n <= 9; n++) {
              if (isValid(board, r, c, n)) {
                board[r][c] = n;
                if (solveBoard(board)) return true;
                board[r][c] = "";
              }
            }
            return false;
          }
        }
      }
      return true;
    }

    function isValid(board, row, col, num) {
      for (let i = 0; i < 9; i++) {
        if (board[row][i] == num || board[i][col] == num) return false;
      }
      const startRow = row - row % 3;
      const startCol = col - col % 3;
      for (let r = 0; r < 3; r++) {
        for (let c = 0; c < 3; c++) {
          if (board[startRow + r][startCol + c] == num) return false;
        }
      }
      return true;
    }

    function startGame() {
      board.innerHTML = "";
      currentDifficulty = difficultyEl.value;
      const [puzzle, solution] = generateSudoku(currentDifficulty);
      startTime = Date.now();
      updateTimer();
      clearInterval(timerInterval);
      timerInterval = setInterval(updateTimer, 1000);
      showBestTime();

      for (let r = 0; r < 9; r++) {
        for (let c = 0; c < 9; c++) {
          const input = document.createElement("div");
          input.classList.add("cell");
          input.dataset.row = r;
          input.dataset.col = c;
          input.contentEditable = puzzle[r][c] === "" ? "true" : "false";
          if (puzzle[r][c] !== "") {
            input.textContent = puzzle[r][c];
            input.classList.add("fixed");
          }
          input.addEventListener("click", () => {
            if (selectedCell) selectedCell.classList.remove("selected");
            selectedCell = input;
            selectedCell.classList.add("selected");
          });
          board.appendChild(input);
        }
      }

      board.dataset.solution = JSON.stringify(solution);
    }

    function checkSudoku() {
      const cells = document.querySelectorAll(".cell");
      let correct = true;
      const solution = JSON.parse(board.dataset.solution);

      cells.forEach(cell => {
        const r = parseInt(cell.dataset.row);
        const c = parseInt(cell.dataset.col);
        if (!cell.classList.contains("fixed")) {
          const val = parseInt(cell.textContent);
          if (val !== solution[r][c]) correct = false;
        }
      });

      if (correct) {
        clearInterval(timerInterval);
        const timeTaken = Math.floor((Date.now() - startTime) / 1000);
        alert("üéâ Congratulations! You solved it in " + timeTaken + " seconds!");
        const bestKey = "best_" + currentDifficulty;
        const prevBest = localStorage.getItem(bestKey);
        if (!prevBest || timeTaken < parseInt(prevBest)) {
          localStorage.setItem(bestKey, timeTaken);
          showBestTime();
          alert("üèÜ New best time!");
        }
      } else {
        alert("‚ùå Something‚Äôs not quite right.");
      }
    }

    function updateTimer() {
      const seconds = Math.floor((Date.now() - startTime) / 1000);
      timerEl.textContent = `‚è±Ô∏è Time: ${seconds}s`;
    }

    function showBestTime() {
      const best = localStorage.getItem("best_" + currentDifficulty);
      bestEl.textContent = best ? `üèÜ Best: ${best}s` : "üèÜ Best: --";
    }

    function toggleHelp() {
      const box = document.getElementById("help-box");
      box.style.display = box.style.display === "none" ? "block" : "none";
    }

    startGame();
  </script>
</body>
</html>
